<!DOCTYPE html>
<html>
  <head>
    <link rel="stylesheet" href="/stylesheets/style2.css" />
    <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
      #chart-container {
      position: relative;
    }
    .body{
      background-color: #A8DA64;
    }
  </style>
  <link rel="icon" type="image/png" href="/images/logo.png">
<title> NutriScan </title>
  </head>
  <body>
    <div class="safearea">
      Product Description
    </div>
    <div class="main">

          <div class = "head">
            <img style="height: 5%; width: 5%; padding-right: 8px;" src="/images/logo.png" alt="">
            <a href= "/"  style="padding-right: 1%; text-decoration:none; color: #2E4312;"> NutriScan > </a>
            <a href = "/products" style="text-decoration: none; color: #2E4312;" > Product</a>
          </div>

      <div class="main-content">
        <div id="chartContainer" style="align-self: center;"></div>
        
      
      </div>
      
    <h1 style="text-align: left; padding-top: 10%; color: #2E4312;">Product Information</h1>
    <hr style="color: black;">
    <p style="font-size: large; display: flex; color: #2E4312;  font-weight: bold; "> NutriScore </p>

  <div class="stars-container">
    <span class="star">★</span>
    <span class="star">★</span>
    <span class="star">★</span>
    <span class="star">★</span>
    <span class="star">★</span>
  </div>

    
    <p style="text-align: left; font-size: large; color: #2E4312; "> ECO Score </p>
    <div id="ecoScoreContainer"></div>
   
    <p style="text-align: left; font-size: large; color: #2E4312; "> Ingredients</p>


  <!-- RANKING -->
    <script>
      var currentRating = 4; // Set the predefined rating
  
      // Initial update of stars based on the predefined rating
      updateStars();
  
      function updateStars() {
        var stars = document.querySelectorAll('.star');
        stars.forEach(function(star, index) {
          if (index < currentRating) {
            star.classList.add('filled');
          } else {
            star.classList.remove('filled');
          }
        });
      }

      
    </script>
  <!-- RANKING -->
  <script>
      async function fetchPieChartSVG() {
      try {
        const response = await fetch('https://us-central1-pioneerhacksv.cloudfunctions.net/pieChart?number=5449000000996');
        const svgContent = await response.text();

        // Inject the SVG into the chartContainer div
        document.getElementById('chartContainer').innerHTML = svgContent;
      } catch (error) {
        console.error('Error fetching data:', error.message);
      }
    }

    fetchPieChartSVG();
  </script>

<script>
  async function fetchEcoScoreData() {
    try {
      const response = await fetch('https://us-central1-pioneerhacksv.cloudfunctions.net/bimbimbombomSUKAAA?number=5449000000996');
      const ecoScoreData = await response.json();

      // Extract the ecoscore_grade property
      const ecoscoreGrade = ecoScoreData.ecoscore_grade;

      // Display the ecoscore_grade in a specific container
      const ecoScoreContainer = document.getElementById('ecoScoreContainer');
      console.log("data", ecoscoreGrade);

      if (ecoscoreGrade === "not-applicable") {
        ecoScoreContainer.innerHTML = "<p>Eco Score is not applicable for this product.</p>";
      } else {
        ecoScoreContainer.innerHTML = `<p>Eco Score Grade: ${ecoscoreGrade}</p>`;
      }

    } catch (error) {
      console.error('Error fetching data:', error.message);
    }
  }

  // Call the fetchEcoScoreData function when the document is ready
  document.addEventListener('DOMContentLoaded', () => {
    fetchEcoScoreData();
  });
</script>

    <div>
  
  </body>
</html>
